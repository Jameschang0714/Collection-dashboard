# **催收績效儀表板專案總結報告**

文件版本： 1.0  
最後更新日期： 2025年8月6日  
專案負責人： James, VP, Chailease Royal Finance Plc.

## **1\. 專案戰略目標 (Strategic Objective)**

本專案的核心戰略目標，是將原始、分散的每日通話紀錄，轉化為一個能夠提供即時、可行動管理洞察的**動態戰情中心 (Dynamic Command Center)**。此儀表板旨在賦能管理層，透過數據驅動的方式，精準掌握團隊與個人的績效表現，從而優化資源分配、提升營運效率，並最終實現業務目標。

## **2\. 核心系統架構 (Core Architecture)**

本專案採用了經典的「後端數據處理」與「前端介面呈現」分離的兩層式架構，確保了系統的穩定性、可擴展性與易維護性。

* **數據管線層 (Data Pipeline \- ETL): merge\_reports.py**  
  * **職責**: 作為整個系統的數據引擎，負責執行 Extract (提取), Transform (轉換), Load (載入) 的所有工作。它會自動整合位於 每日資料底稿/ 中的所有原始報表，並根據核心業務規則，生成一份乾淨、標準化、可供分析的數據源 (consolidated\_report.csv)。  
* **商業智慧層 (Business Intelligence \- BI): dashboard.py**  
  * **職責**: 作為決策的入口，負責將標準化的數據，以最具洞察力的方式呈現給管理層。它提供了多維度的數據探索、視覺化的績效反饋，以及友善的使用者互動介面。

## **3\. 關鍵資產說明 (Key Assets)**

| 檔案/資料夾 | 類型 | 核心職能 |
| :---- | :---- | :---- |
| **merge\_reports.py** | Python 腳本 | **數據整合引擎**：自動化合併每日報表，並根據分組名單進行數據清洗與賦值。 |
| **dashboard.py** | Streamlit 應用 | **戰情中心介面**：提供互動式的數據儀表板，包含月度與每日績效視圖。 |
| **consolidated\_report.csv** | 數據源 | **單一事實來源 (SSoT)**：儀表板唯一的、經過清洗與整合的數據基礎。 |
| **分組名單.xlsx** | 業務規則檔 | **組織藍圖**：定義催員的團隊歸屬與正確姓名，是數據賦值的權威性來源。 |
| **各組每日撥通數上下限.xlsx** | 績效規則檔 | **績效合約 (SLA)**：定義各團隊的績效標準，是視覺化呈現的依據。 |
| **每日資料底稿/** | 原始數據 | **數據源頭**：存放每日從系統導出的原始通話紀錄 Excel 檔案。 |

## **4\. 核心業務邏輯與實現 (Business Logic & Implementation)**

### **4.1. 數據整合 (merge\_reports.py)**

* **權威性映射 (Authoritative Mapping)**：為從根本上杜絕數據不一致的問題，腳本採用了 Pandas .map() 的方法。它會先讀取 分組名單.xlsx，建立一個「一個 ID，一個團隊」及「一個 ID，一個姓名」的權威性映射表。  
* **數據賦值 (Data Assignment)**：腳本在整合所有每日報表後，會使用這個權威映射表，為每一筆通話紀錄，精準地分配其所屬的 Group 和正確的 Agent Name。  
* **數據清洗 (Data Cleansing)**：任何在 分組名單.xlsx 中找不到對應的催員紀錄，都會被視為不在管理範疇內，並在數據整合的最後一步被自動過濾，確保最終產出的 consolidated\_report.csv 絕對純淨。

### **4.2. 儀表板呈現 (dashboard.py)**

#### **月度催員接通數儀表板**

* **穩健的數據塑形 (Robust Data Shaping)**：為了解決 pivot\_table 在複雜場景下的不穩定性，我們採用了更為基礎且穩健的 groupby().unstack() 方法，來手動建構樞紐分析表，確保數據轉換過程的絕對可控。  
* **績效「紅綠燈」系統 (Performance "Traffic Light" System)**：儀表板會載入 各組每日撥通數上下限.xlsx 的設定，並對「總成功撥打數」這一核心 KPI，進行條件化著色，使績效表現一目了然。  
* **精緻化呈現 (Refined Presentation)**：日期欄位被格式化為更具可讀性的 MM/DD 格式，提升了使用者體驗。

#### **催員每日撥打狀況報告**

* **深度績效洞察 (Deep Performance Insight)**：此報告不再是原始數據的羅列，而是一個自動化的 KPI 計算引擎。  
* **核心指標計算**: 自動計算 總撥打數, 總成功撥打數, 總處理案件數, 總成功案件數, 總通話時長。  
* **衍生指標分析**: 進一步運算出更具管理價值的 重複撥打率 與 平均通話時長。  
* **顯性運算流程 (Explicit Calculation Process)**：為解決 Timedelta 類型的計算失準問題，我們採用了「秒數轉換 \-\> 數字運算 \-\> 格式還原」的顯性流程，確保了「平均通話時長」的計算精度。

## **5\. 專案演進與重大決策歷程 (Project Evolution & Key Decisions)**

本專案的成功，是建立在一系列嚴謹的偵錯與果斷的架構決策之上。

1. **數據錯亂的根源探索**: 我們共同經歷了一個從懷疑「儀表板呈現」，到審視「數據整合腳本」，再到檢驗「源頭資料」，最終鎖定在「框架內部狀態管理與數據處理交互作用」的深度偵錯過程。  
2. **merge\_reports.py 的架構演進**: 核心決策是**棄用 pd.merge()，改採 .map()** 的權威性映射方法來進行團隊與姓名分配，從流程上根絕了因數據不一致而產生的合併錯誤。  
3. **dashboard.py 的架構演進**:  
   * **數據塑形**: 核心決策是**棄用 pivot\_table，改採 groupby().unstack()**，提升了數據轉換的穩定性。  
   * **數據篩選**: 核心決策是**重構為「關注點分離」架構**，將篩選邏輯從主程式下放到顯示函數內部，徹底解決了因 Streamlit 狀態管理而引發的數據篩選錯亂問題。  
   * **數據呈現**: 核心決策是**棄用 .hide()，改採 column\_config**，解決了版本相容性問題，並使架構更為現代化。  
4. **從「姓名比對」到「ID 核心」的戰略轉向**: 在偵錯過程中，您果斷地提出以 Agent ID 作為唯一識別值的策略，雖然最終版本恢復了姓名顯示，但這個「以 ID 為核心」的思維，是我們後續得以建立穩固數據流程的指導原則。